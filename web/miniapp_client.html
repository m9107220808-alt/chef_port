<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–®–ï–§ –ü–û–†–¢ | –†—ã–±–∞ –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-deep: #0d1b2a;
            --bg-card: #1b2838;
            --bg-surface: #22354a;
            --text-white: #ffffff;
            --text-light: #b8c5d6;
            --text-muted: #6b7c93;
            --accent-blue: #4da6ff;
            --accent-orange: #ff6b35;
            --border-subtle: rgba(255, 255, 255, 0.1);
            --gradient-hero: linear-gradient(180deg, #0d1b2a 0%, #1a3a5c 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', -apple-system, sans-serif;
            background: var(--bg-deep);
            color: var(--text-white);
            min-height: 100vh;
            padding-bottom: 80px;
            -webkit-font-smoothing: antialiased;
        }

        .header {
            background: var(--gradient-hero);
            padding: 16px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .logo-box {
            border: 2px solid var(--text-white);
            padding: 6px 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1.1;
        }

        .logo-text-top,
        .logo-text-bottom {
            font-size: 14px;
            font-weight: 800;
            letter-spacing: 3px;
        }

        .cart-btn {
            position: relative;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 10px 16px;
            color: var(--text-white);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent-orange);
            color: white;
            font-size: 11px;
            font-weight: 700;
            min-width: 20px;
            height: 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 14px 16px 14px 48px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            color: var(--text-white);
            font-size: 15px;
            font-weight: 500;
            outline: none;
            transition: all 0.3s;
        }

        .search-input:focus {
            background: rgba(255, 255, 255, 0.12);
            border-color: var(--accent-blue);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 18px;
        }

        /* –ö–ê–¢–ï–ì–û–†–ò–ò */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 16px;
        }

        .category-card {
            position: relative;
            height: 90px;
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s;
            display: flex;
            align-items: flex-end;
            padding: 12px;
        }

        .category-card:active {
            transform: scale(0.97);
        }

        .category-card.active {
            border: 2px solid var(--accent-blue);
        }

        .category-name {
            color: white;
            font-size: 13px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .category-icon {
            font-size: 20px;
        }

        /* –ö—Ä–∞—Å–∏–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π */
        .cat-all {
            background: linear-gradient(135deg, #1a3a5c 0%, #2d5a87 100%);
        }

        .cat-fish {
            background: linear-gradient(135deg, #0f4c75 0%, #3282b8 100%);
        }

        .cat-seafood {
            background: linear-gradient(135deg, #b83280 0%, #e91e63 100%);
        }

        .cat-caviar {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
        }

        .cat-other {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }

        .section-header {
            padding: 0 16px;
            margin: 20px 0 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-link {
            color: var(--accent-blue);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
        }

        /* –•–ò–¢–´ –ü–†–û–î–ê–ñ */
        .hits-scroll {
            display: flex;
            gap: 12px;
            padding: 0 16px 16px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .hits-scroll::-webkit-scrollbar {
            display: none;
        }

        .hit-card {
            flex-shrink: 0;
            width: 150px;
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border-subtle);
        }

        .hit-img-wrap {
            position: relative;
            height: 100px;
            background: linear-gradient(135deg, #1a3a5c, #2d5a87);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .hit-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            background: linear-gradient(135deg, #ff6b35, #ff4444);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .hit-body {
            padding: 12px;
        }

        .hit-name {
            font-size: 12px;
            font-weight: 600;
            line-height: 1.3;
            height: 32px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .hit-price {
            font-size: 15px;
            font-weight: 800;
        }

        .hit-unit {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* –¢–û–í–ê–†–´ */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 0 16px 16px;
        }

        .product-card {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border-subtle);
        }

        .product-img-wrap {
            position: relative;
            height: 120px;
            background: linear-gradient(135deg, #1a3a5c, #2d5a87);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .product-hit-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            background: linear-gradient(135deg, #ff6b35, #ff4444);
            color: white;
            font-size: 9px;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .product-body {
            padding: 12px;
        }

        .product-name {
            font-size: 12px;
            font-weight: 600;
            line-height: 1.3;
            height: 32px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .product-price {
            font-size: 15px;
            font-weight: 800;
        }

        .product-unit {
            font-size: 10px;
            color: var(--text-muted);
        }

        .add-btn {
            width: 34px;
            height: 34px;
            background: var(--accent-blue);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-btn:active {
            transform: scale(0.9);
            background: #3d8ed9;
        }

        /* –ù–ê–í–ò–ì–ê–¶–ò–Ø */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-top: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-around;
            padding: 10px 0 24px;
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--text-muted);
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            padding: 4px 12px;
        }

        .nav-item.active {
            color: var(--accent-blue);
        }

        .nav-icon {
            font-size: 22px;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        /* –ö–û–†–ó–ò–ù–ê */
        .cart-container {
            padding: 16px;
        }

        .cart-empty {
            text-align: center;
            padding: 50px 20px;
            color: var(--text-muted);
        }

        .cart-empty-icon {
            font-size: 56px;
            margin-bottom: 12px;
        }

        .cart-item {
            display: flex;
            gap: 12px;
            padding: 14px;
            background: var(--bg-card);
            border-radius: 14px;
            margin-bottom: 10px;
            border: 1px solid var(--border-subtle);
        }

        .cart-item-img {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            background: linear-gradient(135deg, #1a3a5c, #2d5a87);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .cart-item-price {
            font-size: 15px;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .cart-item-qty {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 8px;
        }

        .qty-btn {
            width: 30px;
            height: 30px;
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            color: var(--text-white);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-total-bar {
            position: fixed;
            bottom: 78px;
            left: 16px;
            right: 16px;
            background: linear-gradient(135deg, #4da6ff, #2d8ed9);
            border-radius: 16px;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-weight: 700;
            box-shadow: 0 8px 24px rgba(77, 166, 255, 0.4);
            cursor: pointer;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
            grid-column: 1 / -1;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-subtle);
            border-top-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 12px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .profile-container {
            padding: 16px;
        }

        .profile-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--border-subtle);
            text-align: center;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4da6ff, #2d8ed9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin: 0 auto 16px;
        }

        .profile-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .profile-id {
            color: var(--text-muted);
            font-size: 13px;
        }

        .orders-container {
            padding: 16px;
        }

        .order-card {
            background: var(--bg-card);
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 10px;
            border: 1px solid var(--border-subtle);
            border-left: 4px solid var(--accent-blue);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }

        .order-id {
            font-weight: 700;
            font-size: 14px;
        }

        .order-total {
            color: var(--accent-blue);
            font-weight: 700;
        }

        .order-status {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* –†–ê–°–®–ò–†–ï–ù–ù–´–ô –ü–†–û–§–ò–õ–¨ */
        .profile-section {
            margin-top: 20px;
        }

        .profile-field {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 14px 16px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border-subtle);
        }

        .field-label {
            font-size: 13px;
            color: var(--text-muted);
        }

        .field-value {
            font-size: 14px;
            font-weight: 600;
        }

        .profile-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .profile-btn {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 16px;
            color: var(--text-white);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .profile-btn:active {
            transform: scale(0.97);
            background: var(--bg-surface);
        }

        /* –ö–û–ù–¢–ê–ö–¢–´ –ò –ò–ù–§–û */
        .info-container {
            padding: 16px;
        }

        .info-card {
            background: var(--bg-card);
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            gap: 14px;
            align-items: center;
            border: 1px solid var(--border-subtle);
        }

        .info-card.clickable {
            cursor: pointer;
        }

        .info-card.clickable:active {
            transform: scale(0.98);
        }

        .info-icon {
            font-size: 28px;
        }

        .info-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .info-text {
            font-size: 13px;
            color: var(--text-muted);
        }

        .back-btn {
            display: block;
            margin: 16px;
            padding: 14px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            color: var(--text-white);
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
        }

        /* –û–§–û–†–ú–õ–ï–ù–ò–ï –ó–ê–ö–ê–ó–ê */
        .checkout-container {
            padding: 16px;
        }

        .checkout-field {
            margin-bottom: 16px;
        }

        .checkout-field label {
            display: block;
            font-size: 13px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .checkout-field input,
        .checkout-field textarea {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            color: var(--text-white);
            font-size: 15px;
            outline: none;
        }

        .checkout-field input:focus,
        .checkout-field textarea:focus {
            border-color: var(--accent-blue);
        }

        .checkout-field textarea {
            min-height: 80px;
            resize: none;
        }

        .delivery-options,
        .payment-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .delivery-btn,
        .payment-btn {
            padding: 14px;
            background: var(--bg-card);
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            color: var(--text-white);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .delivery-btn.active,
        .payment-btn.active {
            border-color: var(--accent-blue);
            background: rgba(77, 166, 255, 0.1);
        }

        .checkout-summary {
            background: var(--bg-card);
            border-radius: 14px;
            padding: 16px;
            margin: 20px 0;
            border: 1px solid var(--border-subtle);
        }

        .checkout-total {
            font-size: 18px;
            font-weight: 800;
            text-align: center;
        }

        .checkout-submit {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #4da6ff, #2d8bdb);
            border: none;
            border-radius: 14px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin-bottom: 10px;
        }

        .checkout-submit:active {
            transform: scale(0.98);
        }

        /* –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –¢–û–í–ê–†–ê */
        .product-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .product-modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 20px;
            max-width: 360px;
            width: 100%;
            overflow: hidden;
        }

        .modal-img {
            height: 180px;
            background: linear-gradient(135deg, #1a3a5c, #2d5a87);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .modal-price {
            font-size: 22px;
            font-weight: 800;
            color: var(--accent-blue);
            margin-bottom: 16px;
        }

        .modal-qty {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .qty-modal-btn {
            width: 44px;
            height: 44px;
            background: var(--bg-surface);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 22px;
            cursor: pointer;
        }

        .qty-value {
            font-size: 20px;
            font-weight: 700;
            min-width: 60px;
            text-align: center;
        }

        .modal-add-btn {
            width: 100%;
            padding: 16px;
            background: var(--accent-blue);
            border: none;
            border-radius: 14px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }

        .modal-close {
            width: 100%;
            padding: 12px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 14px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>

<body>

    <header class="header">
        <div class="header-top">
            <div class="logo-box">
                <span class="logo-text-top">–®–ï–§</span>
                <span class="logo-text-bottom">–ü–û–†–¢</span>
            </div>
            <button class="cart-btn" onclick="switchView('cart')">
                üõí <span id="cart-total-header">0 ‚ÇΩ</span>
                <span class="cart-badge" id="cart-count">0</span>
            </button>
        </div>
        <div class="search-box">
            <span class="search-icon">üîç</span>
            <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ —Ä—ã–±—ã –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç–æ–≤..." id="search-input"
                oninput="filterProducts()">
        </div>
    </header>

    <main class="view active" id="view-catalog">
        <div class="categories-grid" id="categories-grid"></div>

        <div id="hits-section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">üî• –•–∏—Ç—ã –ø—Ä–æ–¥–∞–∂</h2>
                <span class="section-link" onclick="selectCategory('all')">–í—Å–µ ‚Üí</span>
            </div>
            <div class="hits-scroll" id="hits-container"></div>
        </div>

        <div class="section-header">
            <h2 class="section-title" id="products-title">üì¶ –ö–∞—Ç–∞–ª–æ–≥</h2>
        </div>
        <div class="products-grid" id="products-grid">
            <div class="loading">
                <div class="spinner"></div>
                –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...
            </div>
        </div>
    </main>

    <div class="view" id="view-cart">
        <div class="section-header" style="margin-top: 16px;">
            <h2 class="section-title">üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>
        </div>
        <div class="cart-container" id="cart-items">
            <div class="cart-empty">
                <div class="cart-empty-icon">üõí</div>
                <div>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>
            </div>
        </div>
        <div class="cart-total-bar" id="cart-total-bar" style="display: none;" onclick="checkout()">
            <span>–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</span>
            <span id="cart-total">0 ‚ÇΩ</span>
        </div>
    </div>

    <div class="view" id="view-orders">
        <div class="section-header" style="margin-top: 16px;">
            <h2 class="section-title">üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h2>
        </div>
        <div class="orders-container" id="orders-list">
            <div class="cart-empty">
                <div class="cart-empty-icon">üì¶</div>
                <div>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</div>
            </div>
        </div>
    </div>

    <div class="view" id="view-profile">
        <div class="profile-container" style="margin-top: 16px; padding: 16px;">
            <div class="profile-card">
                <div class="profile-avatar">üë§</div>
                <div class="profile-name" id="profile-name">–ì–æ—Å—Ç—å</div>
                <div class="profile-id" id="profile-id">ID: ---</div>
            </div>

            <div class="profile-section">
                <div class="profile-field">
                    <span class="field-label">üì± –¢–µ–ª–µ—Ñ–æ–Ω</span>
                    <span class="field-value" id="profile-phone">–ù–µ —É–∫–∞–∑–∞–Ω</span>
                </div>
                <div class="profile-field">
                    <span class="field-label">üìç –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                    <span class="field-value" id="profile-address">–ù–µ —É–∫–∞–∑–∞–Ω</span>
                </div>
            </div>

            <div class="profile-actions">
                <button class="profile-btn" onclick="switchView('contacts')">
                    <span>‚òéÔ∏è</span> –ö–æ–Ω—Ç–∞–∫—Ç—ã
                </button>
                <button class="profile-btn" onclick="switchView('info')">
                    <span>‚ùì</span> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                </button>
            </div>
        </div>
    </div>

    <!-- –ö–û–ù–¢–ê–ö–¢–´ -->
    <div class="view" id="view-contacts">
        <div class="section-header" style="margin-top: 16px;">
            <h2 class="section-title">‚òéÔ∏è –ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
        </div>
        <div class="info-container">
            <div class="info-card">
                <div class="info-icon">üìç</div>
                <div class="info-content">
                    <div class="info-title">–ê–¥—Ä–µ—Å</div>
                    <div class="info-text">–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –†—ã–±–Ω–∞—è, 1</div>
                </div>
            </div>
            <div class="info-card">
                <div class="info-icon">üìû</div>
                <div class="info-content">
                    <div class="info-title">–¢–µ–ª–µ—Ñ–æ–Ω</div>
                    <div class="info-text">+7 (495) 123-45-67</div>
                </div>
            </div>
            <div class="info-card">
                <div class="info-icon">‚è∞</div>
                <div class="info-content">
                    <div class="info-title">–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã</div>
                    <div class="info-text">–ü–Ω-–í—Å: 9:00 - 21:00</div>
                </div>
            </div>
            <div class="info-card">
                <div class="info-icon">üí¨</div>
                <div class="info-content">
                    <div class="info-title">Telegram</div>
                    <div class="info-text">@chefport</div>
                </div>
            </div>
        </div>
        <button class="back-btn" onclick="switchView('profile')">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
    </div>

    <!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø -->
    <div class="view" id="view-info">
        <div class="section-header" style="margin-top: 16px;">
            <h2 class="section-title">‚ùì –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
        </div>
        <div class="info-container">
            <div class="info-card clickable" onclick="showInfoSection('about')">
                <div class="info-icon">üêü</div>
                <div class="info-content">
                    <div class="info-title">–û –∫–æ–º–ø–∞–Ω–∏–∏</div>
                    <div class="info-text">–°–≤–µ–∂–∞—è —Ä—ã–±–∞ –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã</div>
                </div>
            </div>
            <div class="info-card clickable" onclick="showInfoSection('delivery')">
                <div class="info-icon">üöö</div>
                <div class="info-content">
                    <div class="info-title">–î–æ—Å—Ç–∞–≤–∫–∞</div>
                    <div class="info-text">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç 3000‚ÇΩ</div>
                </div>
            </div>
            <div class="info-card clickable" onclick="showInfoSection('payment')">
                <div class="info-icon">üí≥</div>
                <div class="info-content">
                    <div class="info-title">–û–ø–ª–∞—Ç–∞</div>
                    <div class="info-text">–ù–∞–ª–∏—á–Ω—ã–µ, –∫–∞—Ä—Ç–∞, –ø–µ—Ä–µ–≤–æ–¥</div>
                </div>
            </div>
        </div>
        <button class="back-btn" onclick="switchView('profile')">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
    </div>

    <!-- –û–§–û–†–ú–õ–ï–ù–ò–ï –ó–ê–ö–ê–ó–ê -->
    <div class="view" id="view-checkout">
        <div class="section-header" style="margin-top: 16px;">
            <h2 class="section-title">üìù –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
        </div>
        <div class="checkout-container">
            <div class="checkout-field">
                <label>üë§ –í–∞—à–µ –∏–º—è</label>
                <input type="text" id="checkout-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
            </div>
            <div class="checkout-field">
                <label>üì± –¢–µ–ª–µ—Ñ–æ–Ω</label>
                <input type="tel" id="checkout-phone" placeholder="+7 (___) ___-__-__">
            </div>
            <div class="checkout-field">
                <label>üöö –°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è</label>
                <div class="delivery-options">
                    <button class="delivery-btn active" onclick="setDelivery('pickup')">üè™ –°–∞–º–æ–≤—ã–≤–æ–∑</button>
                    <button class="delivery-btn" onclick="setDelivery('delivery')">üöö –î–æ—Å—Ç–∞–≤–∫–∞</button>
                </div>
            </div>
            <div class="checkout-field" id="address-field" style="display: none;">
                <label>üìç –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                <input type="text" id="checkout-address" placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å">
            </div>
            <div class="checkout-field">
                <label>üí≥ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label>
                <div class="payment-options">
                    <button class="payment-btn active" onclick="setPayment('cash')">üíµ –ù–∞–ª–∏—á–Ω—ã–µ</button>
                    <button class="payment-btn" onclick="setPayment('card')">üí≥ –ö–∞—Ä—Ç–∞</button>
                </div>
            </div>
            <div class="checkout-field">
                <label>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                <textarea id="checkout-comment" placeholder="–ü–æ–∂–µ–ª–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É..."></textarea>
            </div>

            <div class="checkout-summary">
                <div class="checkout-total">–ò—Ç–æ–≥–æ: <span id="checkout-total-amount">0</span> ‚ÇΩ</div>
            </div>

            <button class="checkout-submit" onclick="submitOrder()">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
            <button class="back-btn" onclick="switchView('cart')">‚¨ÖÔ∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchView('catalog')" data-view="catalog">
            <span class="nav-icon">üè†</span>
            <span>–ö–∞—Ç–∞–ª–æ–≥</span>
        </div>
        <div class="nav-item" onclick="switchView('orders')" data-view="orders">
            <span class="nav-icon">üì¶</span>
            <span>–ó–∞–∫–∞–∑—ã</span>
        </div>
        <div class="nav-item" onclick="switchView('cart')" data-view="cart">
            <span class="nav-icon">üõí</span>
            <span>–ö–æ—Ä–∑–∏–Ω–∞</span>
        </div>
        <div class="nav-item" onclick="switchView('profile')" data-view="profile">
            <span class="nav-icon">üë§</span>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </nav>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –¢–û–í–ê–†–ê -->
    <div class="product-modal" id="product-modal" onclick="if(event.target===this) closeProductModal()">
        <div class="modal-content">
            <div class="modal-img" id="modal-icon">üêü</div>
            <div class="modal-body">
                <div class="modal-name" id="modal-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</div>
                <div class="modal-price" id="modal-price">0 ‚ÇΩ/–∫–≥</div>
                <div class="modal-qty">
                    <button class="qty-modal-btn" onclick="changeModalQty(-1)">‚àí</button>
                    <span class="qty-value" id="modal-qty-value">1 –∫–≥</span>
                    <button class="qty-modal-btn" onclick="changeModalQty(1)">+</button>
                </div>
                <button class="modal-add-btn" onclick="addFromModal()">üì• –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="modal-close" onclick="closeProductModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin + '/api';
        const tg = window.Telegram?.WebApp;
        let USER_ID = 0;

        // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        const DEMO_CATEGORIES = [
            { id: 1, code: 'fish', name: '–†—ã–±–∞', sort_order: 1 },
            { id: 2, code: 'seafood', name: '–ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã', sort_order: 2 },
            { id: 3, code: 'caviar', name: '–ò–∫—Ä–∞', sort_order: 3 },
            { id: 4, code: 'other', name: '–ë–∞–∫–∞–ª–µ—è', sort_order: 4 }
        ];

        const DEMO_PRODUCTS = [
            { id: 1, categoryid: 1, name: '–§–∏–ª–µ —Ñ–æ—Ä–µ–ª–∏ —Å–ª–∞–±–æ—Å–æ–ª–µ–Ω–æ–µ', priceperkg: 1890, is_weighted: true, is_hit: true, image_url: '/images/category_fish.png' },
            { id: 2, categoryid: 1, name: '–§–∏–ª–µ —Å–µ–º–≥–∏ —Å–ª–∞–±–æ—Å–æ–ª–µ–Ω–æ–µ', priceperkg: 2290, is_weighted: true, is_hit: true, image_url: '/images/fish_salmon.png' },
            { id: 3, categoryid: 1, name: '–§–∏–ª–µ –Ω–µ—Ä–∫–∏ —Å–ª–∞–±–æ—Å–æ–ª–µ–Ω–æ–µ', priceperkg: 1950, is_weighted: true, is_hit: false, image_url: '/images/category_fish.png' },
            { id: 4, categoryid: 1, name: '–§–∏–ª–µ –≥–æ—Ä–±—É—à–∏ —Å–ª–∞–±–æ—Å–æ–ª–µ–Ω–æ–µ', priceperkg: 1290, is_weighted: true, is_hit: false, image_url: '/images/category_fish.png' },
            { id: 5, categoryid: 2, name: '–ö—Ä–µ–≤–µ—Ç–∫–∏ –≤ –≥–æ—Ä—á–∏—á–Ω–æ–º —Å–æ—É—Å–µ', priceperkg: 890, is_weighted: false, is_hit: true, image_url: '/images/category_seafood.png' },
            { id: 6, categoryid: 2, name: '–ú–∏–¥–∏–∏ –≤ –≥–æ—Ä—á–∏—á–Ω–æ–º —Å–æ—É—Å–µ', priceperkg: 590, is_weighted: false, is_hit: false, image_url: '/images/category_seafood.png' },
            { id: 7, categoryid: 2, name: '–ö–∞–ª—å–º–∞—Ä –≤ —Ç–∞—Ä-—Ç–∞—Ä —Å–æ—É—Å–µ', priceperkg: 680, is_weighted: false, is_hit: false, image_url: '/images/seafood_mix.png' },
            { id: 8, categoryid: 2, name: '–ì—Ä–µ–±–µ—à–∫–∏ –º–æ—Ä—Å–∫–∏–µ', priceperkg: 2100, is_weighted: true, is_hit: true, image_url: '/images/seafood_mix.png' },
            { id: 9, categoryid: 3, name: '–ò–∫—Ä–∞ –≥–æ—Ä–±—É—à–∏ 200–≥', priceperkg: 1780, is_weighted: false, is_hit: true, image_url: '/images/category_caviar.png' },
            { id: 10, categoryid: 3, name: '–ò–∫—Ä–∞ –∫–µ—Ç—ã 130–≥', priceperkg: 1183, is_weighted: false, is_hit: false, image_url: '/images/category_caviar.png' },
            { id: 11, categoryid: 4, name: '–ö–æ—Ç–ª–µ—Ç—ã –ª–æ—Å–æ—Å–µ–≤—ã–µ', priceperkg: 750, is_weighted: false, is_hit: true, image_url: '/images/hero.png' },
            { id: 12, categoryid: 4, name: '–ü–µ–ª—å–º–µ–Ω–∏ –ª–æ—Å–æ—Å–µ–≤—ã–µ —Ü–≤–µ—Ç–Ω—ã–µ', priceperkg: 690, is_weighted: false, is_hit: false, image_url: '/images/hero.png' }
        ];

        // ... (CATEGORY_CONFIG —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω)

        function getProductIcon(product) {
            // –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
            if (product.image_url) {
                const emoji = getEmojiByCategory(product.categoryid);
                const categoryImage = getCategoryImage(product.categoryid);
                return `<img src="${product.image_url}" alt="${product.name}" 
                    style="width:100%; height:100%; object-fit:cover; border-radius:12px;"
                    onerror="this.onerror=null; this.src='${categoryImage}';">`;
            }
            // Fallback –Ω–∞ —Ñ–æ—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const categoryImage = getCategoryImage(product.categoryid);
            return `<img src="${categoryImage}" alt="${product.name}" 
                style="width:100%; height:100%; object-fit:cover; border-radius:12px;">`;
        }

        function getCategoryImage(categoryId) {
            const cat = allCategories.find(c => c.id === categoryId);
            if (!cat) return '/images/hero.png';
            return (CATEGORY_CONFIG[cat.code] || CATEGORY_CONFIG.other).image || '/images/hero.png';
        }

        function getEmojiByCategory(categoryId) {
            const cat = allCategories.find(c => c.id === categoryId);
            if (!cat) return 'üêü';
            return (CATEGORY_CONFIG[cat.code] || CATEGORY_CONFIG.other).icon;
        }

        function renderProducts() {
            const container = document.getElementById('products-grid');
            let filtered = allProducts;

            if (currentCategory !== 'all') {
                const cat = allCategories.find(c => c.code === currentCategory);
                if (cat) filtered = allProducts.filter(p => p.categoryid === cat.id);
            }

            const search = document.getElementById('search-input').value.toLowerCase();
            if (search) filtered = filtered.filter(p => p.name.toLowerCase().includes(search));

            if (!filtered.length) {
                container.innerHTML = '<div class="loading">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            container.innerHTML = filtered.map(p => `
                <div class="product-card">
                    <div class="product-img-wrap" onclick="openProductModal(${p.id})">
                        ${getProductIcon(p)}
                        ${p.is_hit ? '<div class="product-hit-badge">üî• –•–ò–¢</div>' : ''}
                    </div>
                    <div class="product-body">
                        <div class="product-name" onclick="openProductModal(${p.id})">${p.name}</div>
                        <div class="product-footer">
                            <div>
                                <div class="product-price">${Math.round(p.priceperkg)} ‚ÇΩ</div>
                                <div class="product-unit">${p.is_weighted ? '–∑–∞ –∫–≥' : '–∑–∞ —à—Ç'}</div>
                            </div>
                            <button class="add-btn" onclick="addToCart(${p.id})">+</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderHits() {
            const hits = allProducts.filter(p => p.is_hit);
            const section = document.getElementById('hits-section');
            const container = document.getElementById('hits-container');

            if (!hits.length) { section.style.display = 'none'; return; }

            section.style.display = 'block';
            container.innerHTML = hits.slice(0, 8).map(p => `
                <div class="hit-card" onclick="openProductModal(${p.id})">
                    <div class="hit-img-wrap">
                        ${getProductIcon(p)}
                        <div class="hit-badge">üî• –•–∏—Ç</div>
                    </div>
                    <div class="hit-body">
                        <div class="hit-name">${p.name}</div>
                        <div class="hit-price">${Math.round(p.priceperkg)} ‚ÇΩ <span class="hit-unit">/${p.is_weighted ? '–∫–≥' : '—à—Ç'}</span></div>
                    </div>
                </div>
            `).join('');
        }

        function selectCategory(code) {
            currentCategory = code;
            renderCategories();
            renderProducts();
            const cat = allCategories.find(c => c.code === code);
            const cfg = CATEGORY_CONFIG[code] || CATEGORY_CONFIG.all;
            document.getElementById('products-title').innerHTML = `${cfg.icon} ${cat ? cat.name : '–ö–∞—Ç–∞–ª–æ–≥'}`;
        }

        function filterProducts() { renderProducts(); }

        function addToCart(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            const existing = cart.find(item => item.id === productId);
            if (existing) { existing.qty += 1; }
            else {
                cart.push({
                    id: product.id, name: product.name, price: product.priceperkg,
                    qty: 1, is_weighted: product.is_weighted, categoryid: product.categoryid
                });
            }
            saveCart(); updateCartUI();
            if (tg) tg.HapticFeedback.impactOccurred('light');
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCart(); renderCart(); updateCartUI();
        }

        function updateQty(productId, delta) {
            const item = cart.find(i => i.id === productId);
            if (!item) return;
            item.qty += delta;
            if (item.qty <= 0) { removeFromCart(productId); return; }
            saveCart(); renderCart(); updateCartUI();
        }

        function saveCart() { localStorage.setItem('cart', JSON.stringify(cart)); }

        function updateCartUI() {
            const count = cart.reduce((s, i) => s + i.qty, 0);
            const total = cart.reduce((s, i) => s + i.price * i.qty, 0);
            document.getElementById('cart-count').textContent = count;
            document.getElementById('cart-total-header').textContent = Math.round(total) + ' ‚ÇΩ';
            document.getElementById('cart-total').textContent = Math.round(total) + ' ‚ÇΩ';
            document.getElementById('cart-total-bar').style.display = cart.length ? 'flex' : 'none';
        }

        function getCartItemIcon(item) {
            const cat = allCategories.find(c => c.id === item.categoryid);
            if (!cat) return 'üêü';
            return (CATEGORY_CONFIG[cat.code] || CATEGORY_CONFIG.other).icon;
        }

        function renderCategories() {
            const container = document.getElementById('categories-grid');
            const cfg = CATEGORY_CONFIG;

            let html = '';

            // –ö–∞—Ä—Ç–æ—á–∫–∞ "–í—Å–µ —Ç–æ–≤–∞—Ä—ã"
            const allStyle = cfg.all.image ? `background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.6)), url('${cfg.all.image}') center/cover no-repeat; text-shadow: 0 2px 4px rgba(0,0,0,0.5);` : '';
            html += `
                <div class="category-card ${cfg.all.class} ${currentCategory === 'all' ? 'active' : ''}" 
                    onclick="selectCategory('all')"
                    style="${allStyle}">
                    <span class="category-name"><span class="category-icon">${cfg.all.icon}</span> ${cfg.all.name}</span>
                </div>
            `;

            // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            allCategories.forEach(c => {
                const config = cfg[c.code] || cfg.other;
                const style = config.image ? `background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.6)), url('${config.image}') center/cover no-repeat; text-shadow: 0 2px 4px rgba(0,0,0,0.5);` : '';

                html += `
                    <div class="category-card ${config.class} ${currentCategory === c.code ? 'active' : ''}" 
                        onclick="selectCategory('${c.code}')" 
                        style="${style}">
                        <span class="category-name"><span class="category-icon">${config.icon}</span> ${c.name}</span>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderCart() {
            const container = document.getElementById('cart-items');
            if (!cart.length) {
                container.innerHTML = '<div class="cart-empty"><div class="cart-empty-icon">üõí</div>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>';
                return;
            }
            container.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <div class="cart-item-img">${getCartItemIcon(item)}</div>
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">${Math.round(item.price * item.qty)} ‚ÇΩ</div>
                        <div class="cart-item-qty">
                            <button class="qty-btn" onclick="updateQty(${item.id}, -1)">‚àí</button>
                            <span>${item.qty} ${item.is_weighted ? '–∫–≥' : '—à—Ç'}</span>
                            <button class="qty-btn" onclick="updateQty(${item.id}, 1)">+</button>
                        </div>
                    </div>
                </div>
            `).join('');
            updateCartUI();
        }

        function checkout() {
            if (!cart.length) return;
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
            const total = cart.reduce((s, i) => s + i.price * i.qty, 0);
            document.getElementById('checkout-total-amount').textContent = Math.round(total);

            // –ó–∞–ø–æ–ª–Ω—è–µ–º –∏–º—è –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –µ—Å–ª–∏ –µ—Å—Ç—å
            const userName = document.getElementById('profile-name').textContent;
            if (userName && userName !== '–ì–æ—Å—Ç—å') {
                document.getElementById('checkout-name').value = userName;
            }

            switchView('checkout');
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ checkout
        let checkoutDelivery = 'pickup';
        let checkoutPayment = 'cash';

        function setDelivery(method) {
            checkoutDelivery = method;
            document.querySelectorAll('.delivery-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('address-field').style.display = method === 'delivery' ? 'block' : 'none';
        }

        function setPayment(method) {
            checkoutPayment = method;
            document.querySelectorAll('.payment-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
        }

        async function submitOrder() {
            const name = document.getElementById('checkout-name').value.trim();
            const phone = document.getElementById('checkout-phone').value.trim();
            const address = document.getElementById('checkout-address').value.trim();
            const comment = document.getElementById('checkout-comment').value.trim();

            if (!name) { alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è'); return; }
            if (!phone) { alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω'); return; }
            if (checkoutDelivery === 'delivery' && !address) { alert('–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å'); return; }

            const orderData = {
                user_id: USER_ID,
                customer_name: name,
                customer_phone: phone,
                delivery_method: checkoutDelivery,
                delivery_address: address || null,
                payment_method: checkoutPayment,
                comment: comment || null,
                items: cart.map(i => ({ product_id: i.id, quantity: i.qty }))
            };

            try {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑ –Ω–∞ API
                const res = await fetch(API_BASE + '/orders/', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(orderData)
                });

                if (!res.ok) {
                    const err = await res.json();
                    throw new Error(err.detail || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                }

                const order = await res.json();

                // –¢–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram –µ—Å–ª–∏ –µ—Å—Ç—å
                if (tg) {
                    tg.sendData(JSON.stringify({ ...orderData, order_id: order.id }));
                    tg.HapticFeedback.notificationOccurred('success');
                }

                alert('‚úÖ –ó–∞–∫–∞–∑ #' + order.id + ' –æ—Ñ–æ—Ä–º–ª–µ–Ω!\n\n–ò–º—è: ' + name + '\n–¢–µ–ª–µ—Ñ–æ–Ω: ' + phone + '\n–°—É–º–º–∞: ' + Math.round(order.total_amount) + ' ‚ÇΩ');

            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:', e);
                // Fallback - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ Telegram
                if (tg) {
                    tg.sendData(JSON.stringify(orderData));
                    tg.HapticFeedback.notificationOccurred('success');
                    alert('‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞: ' + e.message);
                    return;
                }
            }

            // –û—á–∏—Å—Ç–∫–∞
            cart = []; saveCart(); renderCart(); updateCartUI();
            document.getElementById('checkout-comment').value = '';
            switchView('catalog');
        }

        // –ò–ù–§–û–†–ú–ê–¶–ò–Ø
        function showInfoSection(section) {
            const texts = {
                about: 'üêü –®–ï–§ –ü–û–†–¢ ‚Äî —Å–≤–µ–∂–∞—è —Ä—ã–±–∞ –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞. –†–∞–±–æ—Ç–∞–µ–º —Å 2015 –≥–æ–¥–∞. –ü—Ä—è–º—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏ —Å –î–∞–ª—å–Ω–µ–≥–æ –í–æ—Å—Ç–æ–∫–∞ –∏ –ú—É—Ä–º–∞–Ω—Å–∫–∞.',
                delivery: 'üöö –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –ú–æ—Å–∫–≤–µ –∏ –ú–û. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 3000‚ÇΩ. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ 1500‚ÇΩ. –î–æ—Å—Ç–∞–≤–∫–∞ –≤ –¥–µ–Ω—å –∑–∞–∫–∞–∑–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –¥–æ 14:00.',
                payment: 'üí≥ –ü—Ä–∏–Ω–∏–º–∞–µ–º: –Ω–∞–ª–∏—á–Ω—ã–µ, –∫–∞—Ä—Ç—ã (Visa, Mastercard, –ú–ò–†), –ø–µ—Ä–µ–≤–æ–¥—ã –ø–æ –°–ë–ü. –û–ø–ª–∞—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–ª–∏ –æ–Ω–ª–∞–π–Ω.'
            };
            alert(texts[section] || '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è');
        }

        // –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –¢–û–í–ê–†–ê
        let modalProduct = null;
        let modalQty = 1;

        function openProductModal(productId) {
            modalProduct = allProducts.find(p => p.id === productId);
            if (!modalProduct) return;

            modalQty = modalProduct.is_weighted ? 0.5 : 1;
            updateModalContent();
            document.getElementById('product-modal').classList.add('active');
            if (tg) tg.HapticFeedback.impactOccurred('light');
        }

        function updateModalContent() {
            document.getElementById('modal-icon').innerHTML = getProductIcon(modalProduct);
            document.getElementById('modal-name').textContent = modalProduct.name;
            document.getElementById('modal-price').textContent = Math.round(modalProduct.priceperkg) + ' ‚ÇΩ/' + (modalProduct.is_weighted ? '–∫–≥' : '—à—Ç');
            document.getElementById('modal-qty-value').textContent = modalQty + (modalProduct.is_weighted ? ' –∫–≥' : ' —à—Ç');
        }

        function changeModalQty(delta) {
            const step = modalProduct.is_weighted ? 0.1 : 1;
            modalQty = Math.max(step, Math.round((modalQty + delta * step) * 10) / 10);
            updateModalContent();
            if (tg) tg.HapticFeedback.selectionChanged();
        }

        function addFromModal() {
            if (!modalProduct) return;

            const existing = cart.find(item => item.id === modalProduct.id);
            if (existing) {
                existing.qty += modalQty;
            } else {
                cart.push({
                    id: modalProduct.id,
                    name: modalProduct.name,
                    price: modalProduct.priceperkg,
                    qty: modalQty,
                    is_weighted: modalProduct.is_weighted,
                    categoryid: modalProduct.categoryid
                });
            }
            saveCart(); updateCartUI();
            closeProductModal();
            if (tg) tg.HapticFeedback.notificationOccurred('success');
        }

        function closeProductModal() {
            document.getElementById('product-modal').classList.remove('active');
            modalProduct = null;
        }

        // –°–¢–ê–†–¢
        loadCategories();
        loadProducts();
        updateCartUI();
    </script>
</body>

</html>